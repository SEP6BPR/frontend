{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/marwa/Desktop/Projects/sep6-frontend/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/marwa/Desktop/Projects/sep6-frontend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/marwa/Desktop/Projects/sep6-frontend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"C:/Users/marwa/Desktop/Projects/sep6-frontend/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport React__default, { createContext, useEffect, useMemo, useState, useRef, useContext, useCallback } from 'react';\nimport { stubbedPublicClientApplication, InteractionStatus, Logger, WrapperSKU, EventType, EventMessageUtils, AccountEntity, InteractionType } from '@azure/msal-browser';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/*\r\n * Stubbed context implementation\r\n * Only used when there is no provider, which is an unsupported scenario\r\n */\n\nvar defaultMsalContext = {\n  instance: stubbedPublicClientApplication,\n  inProgress: InteractionStatus.None,\n  accounts: [],\n  logger: /*#__PURE__*/new Logger({})\n};\nvar MsalContext = /*#__PURE__*/createContext(defaultMsalContext);\nvar MsalConsumer = MsalContext.Consumer;\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\nfunction getChildrenOrFunction(children, args) {\n  if (typeof children === \"function\") {\n    return children(args);\n  }\n\n  return children;\n}\n/**\r\n * Helper function to determine whether 2 arrays are equal\r\n * Used to avoid unnecessary state updates\r\n * @param arrayA\r\n * @param arrayB\r\n */\n\n\nfunction accountArraysAreEqual(arrayA, arrayB) {\n  if (arrayA.length !== arrayB.length) {\n    return false;\n  }\n\n  var comparisonArray = _toConsumableArray(arrayB);\n\n  return arrayA.every(function (elementA) {\n    var elementB = comparisonArray.shift();\n\n    if (!elementA || !elementB) {\n      return false;\n    }\n\n    return elementA.homeAccountId === elementB.homeAccountId && elementA.localAccountId === elementB.localAccountId && elementA.username === elementB.username;\n  });\n}\n/* eslint-disable header/header */\n\n\nvar name = \"@azure/msal-react\";\nvar version = \"1.1.1\";\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\nfunction MsalProvider(_ref) {\n  var instance = _ref.instance,\n      children = _ref.children;\n  useEffect(function () {\n    instance.initializeWrapperLibrary(WrapperSKU.React, version);\n  }, [instance]); // Create a logger instance for msal-react with the same options as PublicClientApplication\n\n  var logger = useMemo(function () {\n    return instance.getLogger().clone(name, version);\n  }, [instance]); // State hook to store accounts\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      accounts = _useState2[0],\n      setAccounts = _useState2[1]; // State hook to store in progress value\n\n\n  var _useState3 = useState(InteractionStatus.Startup),\n      _useState4 = _slicedToArray(_useState3, 2),\n      inProgress = _useState4[0],\n      setInProgress = _useState4[1]; // Mutable object used in the event callback\n\n\n  var inProgressRef = useRef(inProgress);\n  useEffect(function () {\n    var callbackId = instance.addEventCallback(function (message) {\n      switch (message.eventType) {\n        case EventType.ACCOUNT_ADDED:\n        case EventType.ACCOUNT_REMOVED:\n        case EventType.LOGIN_SUCCESS:\n        case EventType.SSO_SILENT_SUCCESS:\n        case EventType.HANDLE_REDIRECT_END:\n        case EventType.LOGIN_FAILURE:\n        case EventType.SSO_SILENT_FAILURE:\n        case EventType.LOGOUT_END:\n        case EventType.ACQUIRE_TOKEN_SUCCESS:\n        case EventType.ACQUIRE_TOKEN_FAILURE:\n          var currentAccounts = instance.getAllAccounts();\n\n          if (!accountArraysAreEqual(currentAccounts, accounts)) {\n            logger.info(\"MsalProvider - updating account state\");\n            setAccounts(currentAccounts);\n          } else {\n            logger.info(\"MsalProvider - no account changes\");\n          }\n\n          break;\n      }\n    });\n    logger.verbose(\"MsalProvider - Registered event callback with id: \".concat(callbackId));\n    return function () {\n      // Remove callback when component unmounts or accounts change\n      if (callbackId) {\n        logger.verbose(\"MsalProvider - Removing event callback \".concat(callbackId));\n        instance.removeEventCallback(callbackId);\n      }\n    };\n  }, [instance, accounts, logger]);\n  useEffect(function () {\n    var callbackId = instance.addEventCallback(function (message) {\n      var status = EventMessageUtils.getInteractionStatusFromEvent(message, inProgressRef.current);\n\n      if (status !== null) {\n        logger.info(\"MsalProvider - \".concat(message.eventType, \" results in setting inProgress from \").concat(inProgressRef.current, \" to \").concat(status));\n        inProgressRef.current = status;\n        setInProgress(status);\n      }\n    });\n    logger.verbose(\"MsalProvider - Registered event callback with id: \".concat(callbackId));\n    instance.handleRedirectPromise().catch(function () {\n      // Errors should be handled by listening to the LOGIN_FAILURE event\n      return;\n    });\n    return function () {\n      if (callbackId) {\n        logger.verbose(\"MsalProvider - Removing event callback \".concat(callbackId));\n        instance.removeEventCallback(callbackId);\n      }\n    };\n  }, [instance, logger]);\n  var contextValue = {\n    instance: instance,\n    inProgress: inProgress,\n    accounts: accounts,\n    logger: logger\n  };\n  return React__default.createElement(MsalContext.Provider, {\n    value: contextValue\n  }, children);\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Returns Msal Context values\r\n */\n\n\nvar useMsal = function useMsal() {\n  return useContext(MsalContext);\n};\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n\nfunction getAccount(instance, accountIdentifiers) {\n  var allAccounts = instance.getAllAccounts();\n\n  if (allAccounts.length > 0 && (accountIdentifiers.homeAccountId || accountIdentifiers.localAccountId || accountIdentifiers.username)) {\n    var matchedAccounts = allAccounts.filter(function (accountObj) {\n      if (accountIdentifiers.username && accountIdentifiers.username.toLowerCase() !== accountObj.username.toLowerCase()) {\n        return false;\n      }\n\n      if (accountIdentifiers.homeAccountId && accountIdentifiers.homeAccountId.toLowerCase() !== accountObj.homeAccountId.toLowerCase()) {\n        return false;\n      }\n\n      if (accountIdentifiers.localAccountId && accountIdentifiers.localAccountId.toLowerCase() !== accountObj.localAccountId.toLowerCase()) {\n        return false;\n      }\n\n      return true;\n    });\n    return matchedAccounts[0] || null;\n  } else {\n    return null;\n  }\n}\n/**\r\n * Given 1 or more accountIdentifiers, returns the Account object if the user is signed-in\r\n * @param accountIdentifiers\r\n */\n\n\nfunction useAccount(accountIdentifiers) {\n  var _useMsal = useMsal(),\n      instance = _useMsal.instance,\n      inProgress = _useMsal.inProgress;\n\n  var initialStateValue = inProgress === InteractionStatus.Startup ? null : getAccount(instance, accountIdentifiers);\n\n  var _useState5 = useState(initialStateValue),\n      _useState6 = _slicedToArray(_useState5, 2),\n      account = _useState6[0],\n      setAccount = _useState6[1];\n\n  useEffect(function () {\n    var currentAccount = getAccount(instance, accountIdentifiers);\n\n    if (!AccountEntity.accountInfoIsEqual(account, currentAccount, true)) {\n      setAccount(currentAccount);\n    }\n  }, [inProgress, accountIdentifiers, instance, account]);\n  return account;\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n\nfunction isAuthenticated(allAccounts, account, matchAccount) {\n  if (matchAccount && (matchAccount.username || matchAccount.homeAccountId || matchAccount.localAccountId)) {\n    return !!account;\n  }\n\n  return allAccounts.length > 0;\n}\n/**\r\n * Returns whether or not a user is currently signed-in. Optionally provide 1 or more accountIdentifiers to determine if a specific user is signed-in\r\n * @param matchAccount\r\n */\n\n\nfunction useIsAuthenticated(matchAccount) {\n  var _useMsal2 = useMsal(),\n      allAccounts = _useMsal2.accounts,\n      inProgress = _useMsal2.inProgress;\n\n  var account = useAccount(matchAccount || {});\n  var initialStateValue = inProgress === InteractionStatus.Startup ? false : isAuthenticated(allAccounts, account, matchAccount);\n\n  var _useState7 = useState(initialStateValue),\n      _useState8 = _slicedToArray(_useState7, 2),\n      hasAuthenticated = _useState8[0],\n      setHasAuthenticated = _useState8[1];\n\n  useEffect(function () {\n    setHasAuthenticated(isAuthenticated(allAccounts, account, matchAccount));\n  }, [allAccounts, account, matchAccount]);\n  return hasAuthenticated;\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Renders child components if user is authenticated\r\n * @param props\r\n */\n\n\nfunction AuthenticatedTemplate(_ref2) {\n  var username = _ref2.username,\n      homeAccountId = _ref2.homeAccountId,\n      localAccountId = _ref2.localAccountId,\n      children = _ref2.children;\n  var context = useMsal();\n  var accountIdentifier = useMemo(function () {\n    return {\n      username: username,\n      homeAccountId: homeAccountId,\n      localAccountId: localAccountId\n    };\n  }, [username, homeAccountId, localAccountId]);\n  var isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n  if (isAuthenticated && context.inProgress !== InteractionStatus.Startup) {\n    return React__default.createElement(React__default.Fragment, null, getChildrenOrFunction(children, context));\n  }\n\n  return null;\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Renders child components if user is unauthenticated\r\n * @param props\r\n */\n\n\nfunction UnauthenticatedTemplate(_ref3) {\n  var username = _ref3.username,\n      homeAccountId = _ref3.homeAccountId,\n      localAccountId = _ref3.localAccountId,\n      children = _ref3.children;\n  var context = useMsal();\n  var accountIdentifier = useMemo(function () {\n    return {\n      username: username,\n      homeAccountId: homeAccountId,\n      localAccountId: localAccountId\n    };\n  }, [username, homeAccountId, localAccountId]);\n  var isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n  if (!isAuthenticated && context.inProgress !== InteractionStatus.Startup && context.inProgress !== InteractionStatus.HandleRedirect) {\n    return React__default.createElement(React__default.Fragment, null, getChildrenOrFunction(children, context));\n  }\n\n  return null;\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Invokes a login call if a user is not currently signed-in. Failed logins can be retried using the login callback returned.\r\n * Optionally provide a request object to be used in the login call.\r\n * Optionally provide a specific user that should be logged in.\r\n * @param interactionType\r\n * @param authenticationRequest\r\n * @param accountIdentifiers\r\n */\n\n\nfunction useMsalAuthentication(interactionType, authenticationRequest, accountIdentifiers) {\n  var _useMsal3 = useMsal(),\n      instance = _useMsal3.instance,\n      inProgress = _useMsal3.inProgress,\n      logger = _useMsal3.logger;\n\n  var isAuthenticated = useIsAuthenticated(accountIdentifiers);\n\n  var _useState9 = useState([null, null]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      _useState10$ = _slicedToArray(_useState10[0], 2),\n      result = _useState10$[0],\n      error = _useState10$[1],\n      setResponse = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      hasBeenCalled = _useState12[0],\n      setHasBeenCalled = _useState12[1];\n\n  var login = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(callbackInteractionType, callbackRequest) {\n      var loginType, loginRequest;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              loginType = callbackInteractionType || interactionType;\n              loginRequest = callbackRequest || authenticationRequest;\n              _context.t0 = loginType;\n              _context.next = _context.t0 === InteractionType.Popup ? 5 : _context.t0 === InteractionType.Redirect ? 7 : _context.t0 === InteractionType.Silent ? 9 : 11;\n              break;\n\n            case 5:\n              logger.verbose(\"useMsalAuthentication - Calling loginPopup\");\n              return _context.abrupt(\"return\", instance.loginPopup(loginRequest));\n\n            case 7:\n              // This promise is not expected to resolve due to full frame redirect\n              logger.verbose(\"useMsalAuthentication - Calling loginRedirect\");\n              return _context.abrupt(\"return\", instance.loginRedirect(loginRequest).then(null));\n\n            case 9:\n              logger.verbose(\"useMsalAuthentication - Calling ssoSilent\");\n              return _context.abrupt(\"return\", instance.ssoSilent(loginRequest));\n\n            case 11:\n              throw \"Invalid interaction type provided.\";\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x, _x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [instance, interactionType, authenticationRequest, logger]);\n  useEffect(function () {\n    var callbackId = instance.addEventCallback(function (message) {\n      switch (message.eventType) {\n        case EventType.LOGIN_SUCCESS:\n        case EventType.SSO_SILENT_SUCCESS:\n          if (message.payload) {\n            setResponse([message.payload, null]);\n          }\n\n          break;\n\n        case EventType.LOGIN_FAILURE:\n        case EventType.SSO_SILENT_FAILURE:\n          if (message.error) {\n            setResponse([null, message.error]);\n          }\n\n          break;\n      }\n    });\n    logger.verbose(\"useMsalAuthentication - Registered event callback with id: \".concat(callbackId));\n    return function () {\n      if (callbackId) {\n        logger.verbose(\"useMsalAuthentication - Removing event callback \".concat(callbackId));\n        instance.removeEventCallback(callbackId);\n      }\n    };\n  }, [instance, logger]);\n  useEffect(function () {\n    if (!hasBeenCalled && !error && !isAuthenticated && inProgress === InteractionStatus.None) {\n      logger.info(\"useMsalAuthentication - No user is authenticated, attempting to login\"); // Ensure login is only called one time from within this hook, any subsequent login attempts should use the callback returned\n\n      setHasBeenCalled(true);\n      login().catch(function () {\n        // Errors are handled by the event handler above\n        return;\n      });\n    }\n  }, [isAuthenticated, inProgress, error, hasBeenCalled, login, logger]);\n  return {\n    login: login,\n    result: result,\n    error: error\n  };\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Attempts to authenticate user if not already authenticated, then renders child components\r\n * @param props\r\n */\n\n\nfunction MsalAuthenticationTemplate(_ref5) {\n  var interactionType = _ref5.interactionType,\n      username = _ref5.username,\n      homeAccountId = _ref5.homeAccountId,\n      localAccountId = _ref5.localAccountId,\n      authenticationRequest = _ref5.authenticationRequest,\n      LoadingComponent = _ref5.loadingComponent,\n      ErrorComponent = _ref5.errorComponent,\n      children = _ref5.children;\n  var accountIdentifier = useMemo(function () {\n    return {\n      username: username,\n      homeAccountId: homeAccountId,\n      localAccountId: localAccountId\n    };\n  }, [username, homeAccountId, localAccountId]);\n  var context = useMsal();\n  var msalAuthResult = useMsalAuthentication(interactionType, authenticationRequest, accountIdentifier);\n  var isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n  if (msalAuthResult.error && context.inProgress === InteractionStatus.None) {\n    if (!!ErrorComponent) {\n      return React__default.createElement(ErrorComponent, Object.assign({}, msalAuthResult));\n    }\n\n    throw msalAuthResult.error;\n  }\n\n  if (isAuthenticated) {\n    return React__default.createElement(React__default.Fragment, null, getChildrenOrFunction(children, msalAuthResult));\n  }\n\n  if (!!LoadingComponent && context.inProgress !== InteractionStatus.None) {\n    return React__default.createElement(LoadingComponent, Object.assign({}, context));\n  }\n\n  return null;\n}\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Higher order component wraps provided component with msal by injecting msal context values into the component's props\r\n * @param Component\r\n */\n\n\nvar withMsal = function withMsal(Component) {\n  var ComponentWithMsal = function ComponentWithMsal(props) {\n    var msal = useMsal();\n    return React__default.createElement(Component, Object.assign({}, props, {\n      msalContext: msal\n    }));\n  };\n\n  var componentName = Component.displayName || Component.name || \"Component\";\n  ComponentWithMsal.displayName = \"withMsal(\".concat(componentName, \")\");\n  return ComponentWithMsal;\n};\n\nexport { AuthenticatedTemplate, MsalAuthenticationTemplate, MsalConsumer, MsalContext, MsalProvider, UnauthenticatedTemplate, useAccount, useIsAuthenticated, useMsal, useMsalAuthentication, version, withMsal };","map":{"version":3,"sources":["../src/MsalContext.ts","../src/utils/utilities.ts","../src/packageMetadata.ts","../src/MsalProvider.tsx","../src/hooks/useMsal.ts","../src/hooks/useAccount.ts","../src/hooks/useIsAuthenticated.ts","../src/components/AuthenticatedTemplate.tsx","../src/components/UnauthenticatedTemplate.tsx","../src/hooks/useMsalAuthentication.ts","../src/components/MsalAuthenticationTemplate.tsx","../src/components/withMsal.tsx"],"names":["defaultMsalContext","instance","inProgress","InteractionStatus","accounts","logger","MsalContext","React","MsalConsumer","Consumer","getChildrenOrFunction","children","args","accountArraysAreEqual","arrayA","arrayB","comparisonArray","elementA","elementB","name","version","MsalProvider","useEffect","WrapperSKU","useMemo","useState","inProgressRef","useRef","callbackId","message","EventType","currentAccounts","setAccounts","status","EventMessageUtils","eventType","current","setInProgress","contextValue","value","useMsal","useContext","allAccounts","accountIdentifiers","matchedAccounts","accountObj","useAccount","initialStateValue","getAccount","currentAccount","AccountEntity","setAccount","matchAccount","useIsAuthenticated","account","isAuthenticated","setHasAuthenticated","AuthenticatedTemplate","context","accountIdentifier","username","homeAccountId","localAccountId","UnauthenticatedTemplate","useMsalAuthentication","interactionType","authenticationRequest","login","useCallback","loginType","callbackInteractionType","loginRequest","callbackRequest","InteractionType","setResponse","setHasBeenCalled","result","error","MsalAuthenticationTemplate","loadingComponent","errorComponent","msalAuthResult","withMsal","Component","ComponentWithMsal","props","msal","msalContext","componentName"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport * as React from \"react\";\nimport { IPublicClientApplication, stubbedPublicClientApplication, Logger, InteractionStatus, AccountInfo } from \"@azure/msal-browser\";\n\nexport interface IMsalContext {\n    instance: IPublicClientApplication;\n    inProgress: InteractionStatus;\n    accounts: AccountInfo[];\n    logger: Logger;\n}\n\n/*\n * Stubbed context implementation\n * Only used when there is no provider, which is an unsupported scenario\n */\nconst defaultMsalContext: IMsalContext = {\n    instance: stubbedPublicClientApplication,\n    inProgress: InteractionStatus.None,\n    accounts: [],\n    logger: new Logger({})\n};\n\nexport const MsalContext = React.createContext<IMsalContext>(\n    defaultMsalContext\n);\nexport const MsalConsumer = MsalContext.Consumer;\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\n\ntype FaaCFunction = <T>(args: T) => React.ReactNode;\n\nexport function getChildrenOrFunction<T>(\n    children: React.ReactNode | FaaCFunction,\n    args: T\n): React.ReactNode {\n    if (typeof children === \"function\") {\n        return children(args);\n    }\n    return children;\n}\n\n/*\n * Utility types\n * Reference: https://github.com/piotrwitek/utility-types\n */\ntype SetDifference<A, B> = A extends B ? never : A;\ntype SetComplement<A, A1 extends A> = SetDifference<A, A1>;\nexport type Subtract<T extends T1, T1 extends object> = Pick<T,SetComplement<keyof T, keyof T1>>;\n\n/**\n * Helper function to determine whether 2 arrays are equal\n * Used to avoid unnecessary state updates\n * @param arrayA \n * @param arrayB \n */\nexport function accountArraysAreEqual(arrayA: Array<AccountIdentifiers>, arrayB: Array<AccountIdentifiers>): boolean {\n    if (arrayA.length !== arrayB.length) {\n        return false;\n    }\n\n    const comparisonArray = [...arrayB];\n\n    return arrayA.every((elementA) => {\n        const elementB = comparisonArray.shift();\n        if (!elementA || !elementB) {\n            return false;\n        }\n\n        return (elementA.homeAccountId === elementB.homeAccountId) && \n               (elementA.localAccountId === elementB.localAccountId) &&\n               (elementA.username === elementB.username);\n    });\n}\n","/* eslint-disable header/header */\nexport const name = \"@azure/msal-react\";\nexport const version = \"1.1.1\";\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport React, { useState, useEffect, useRef, PropsWithChildren, useMemo } from \"react\";\nimport {\n    IPublicClientApplication,\n    EventType,\n    EventMessage,\n    EventMessageUtils,\n    InteractionStatus,\n    Logger,\n    WrapperSKU,\n    AccountInfo\n} from \"@azure/msal-browser\";\nimport { MsalContext, IMsalContext } from \"./MsalContext\";\nimport { accountArraysAreEqual } from \"./utils/utilities\";\nimport { name as SKU, version } from \"./packageMetadata\";\n\nexport type MsalProviderProps = PropsWithChildren<{\n    instance: IPublicClientApplication;\n}>;\n\nexport function MsalProvider({instance, children}: MsalProviderProps): React.ReactElement {\n    useEffect(() => {\n        instance.initializeWrapperLibrary(WrapperSKU.React, version);\n    }, [instance]);\n    // Create a logger instance for msal-react with the same options as PublicClientApplication\n    const logger: Logger = useMemo(() => {\n        return instance.getLogger().clone(SKU, version);\n    }, [instance]);\n\n    // State hook to store accounts\n    const [accounts, setAccounts] = useState<AccountInfo[]>([]);\n    // State hook to store in progress value\n    const [inProgress, setInProgress] = useState<InteractionStatus>(InteractionStatus.Startup);\n    // Mutable object used in the event callback\n    const inProgressRef = useRef(inProgress);\n    \n    useEffect(() => {\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\n            switch (message.eventType) {\n                case EventType.ACCOUNT_ADDED:\n                case EventType.ACCOUNT_REMOVED:\n                case EventType.LOGIN_SUCCESS:\n                case EventType.SSO_SILENT_SUCCESS:\n                case EventType.HANDLE_REDIRECT_END:\n                case EventType.LOGIN_FAILURE:\n                case EventType.SSO_SILENT_FAILURE:\n                case EventType.LOGOUT_END:\n                case EventType.ACQUIRE_TOKEN_SUCCESS:\n                case EventType.ACQUIRE_TOKEN_FAILURE:\n                    const currentAccounts = instance.getAllAccounts();\n                    if (!accountArraysAreEqual(currentAccounts, accounts)) {\n                        logger.info(\"MsalProvider - updating account state\");\n                        setAccounts(currentAccounts);\n                    } else {\n                        logger.info(\"MsalProvider - no account changes\");\n                    }\n                    break;\n            }\n        });\n        logger.verbose(`MsalProvider - Registered event callback with id: ${callbackId}`);\n\n        return () => {\n            // Remove callback when component unmounts or accounts change\n            if (callbackId) {\n                logger.verbose(`MsalProvider - Removing event callback ${callbackId}`);\n                instance.removeEventCallback(callbackId);\n            }\n        };\n    }, [instance, accounts, logger]);\n\n    useEffect(() => {\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\n            const status = EventMessageUtils.getInteractionStatusFromEvent(message, inProgressRef.current);\n            if (status !== null) {\n                logger.info(`MsalProvider - ${message.eventType} results in setting inProgress from ${inProgressRef.current} to ${status}`);\n                inProgressRef.current = status;\n                setInProgress(status);\n            }\n        });\n        logger.verbose(`MsalProvider - Registered event callback with id: ${callbackId}`);\n\n        instance.handleRedirectPromise().catch(() => {\n            // Errors should be handled by listening to the LOGIN_FAILURE event\n            return;\n        });\n\n        return () => {\n            if (callbackId) {\n                logger.verbose(`MsalProvider - Removing event callback ${callbackId}`);\n                instance.removeEventCallback(callbackId);\n            }\n        };\n    }, [instance, logger]);\n\n    const contextValue: IMsalContext = {\n        instance,\n        inProgress,\n        accounts,\n        logger\n    };\n\n    return (\n        <MsalContext.Provider value={contextValue}>\n            {children}\n        </MsalContext.Provider>\n    );\n}\n\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { useContext } from \"react\";\nimport { IMsalContext, MsalContext } from \"../MsalContext\";\n\n/**\n * Returns Msal Context values\n */\nexport const useMsal = (): IMsalContext => useContext(MsalContext);\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { useState, useEffect } from \"react\";\nimport { AccountInfo, IPublicClientApplication, InteractionStatus, AccountEntity } from \"@azure/msal-browser\";\nimport { useMsal } from \"./useMsal\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\n\nfunction getAccount(instance: IPublicClientApplication, accountIdentifiers: AccountIdentifiers): AccountInfo | null {\n    const allAccounts = instance.getAllAccounts();\n    if (allAccounts.length > 0 && (accountIdentifiers.homeAccountId || accountIdentifiers.localAccountId || accountIdentifiers.username)) {\n        const matchedAccounts = allAccounts.filter(accountObj => {\n            if (accountIdentifiers.username && accountIdentifiers.username.toLowerCase() !== accountObj.username.toLowerCase()) {\n                return false;\n            }\n            if (accountIdentifiers.homeAccountId && accountIdentifiers.homeAccountId.toLowerCase() !== accountObj.homeAccountId.toLowerCase()) {\n                return false;\n            }\n            if (accountIdentifiers.localAccountId && accountIdentifiers.localAccountId.toLowerCase() !== accountObj.localAccountId.toLowerCase()) {\n                return false;\n            }\n\n            return true;\n        });\n\n        return matchedAccounts[0] || null;\n    } else {\n        return null;\n    }\n}\n\n/**\n * Given 1 or more accountIdentifiers, returns the Account object if the user is signed-in\n * @param accountIdentifiers \n */\nexport function useAccount(accountIdentifiers: AccountIdentifiers): AccountInfo | null {\n    const { instance, inProgress } = useMsal();\n\n    const initialStateValue = inProgress === InteractionStatus.Startup ? null : getAccount(instance, accountIdentifiers);\n    const [account, setAccount] = useState<AccountInfo|null>(initialStateValue);\n\n    useEffect(() => {\n        const currentAccount = getAccount(instance, accountIdentifiers);\n        if (!AccountEntity.accountInfoIsEqual(account, currentAccount, true)) {\n            setAccount(currentAccount);\n        }\n    }, [inProgress, accountIdentifiers, instance, account]);\n\n    return account;\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { useState, useEffect } from \"react\";\nimport { useMsal } from \"./useMsal\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\nimport { useAccount } from \"./useAccount\";\nimport { AccountInfo, InteractionStatus } from \"@azure/msal-browser\";\n\nfunction isAuthenticated(allAccounts: AccountIdentifiers[], account: AccountInfo | null, matchAccount?: AccountIdentifiers): boolean {\n    if(matchAccount && (matchAccount.username || matchAccount.homeAccountId || matchAccount.localAccountId)) {\n        return !!account;\n    }   \n\n    return allAccounts.length > 0;\n}\n\n/**\n * Returns whether or not a user is currently signed-in. Optionally provide 1 or more accountIdentifiers to determine if a specific user is signed-in\n * @param matchAccount \n */\nexport function useIsAuthenticated(matchAccount?: AccountIdentifiers): boolean {\n    const { accounts: allAccounts, inProgress } = useMsal();\n    const account = useAccount(matchAccount || {});\n\n    const initialStateValue = inProgress === InteractionStatus.Startup ? false : isAuthenticated(allAccounts, account, matchAccount);\n    const [hasAuthenticated, setHasAuthenticated] = useState<boolean>(initialStateValue);\n\n    useEffect(() => {\n        setHasAuthenticated(isAuthenticated(allAccounts, account, matchAccount));\n    }, [allAccounts, account, matchAccount]);\n\n    return hasAuthenticated;\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport React, { PropsWithChildren, useMemo } from \"react\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\nimport { getChildrenOrFunction } from \"../utils/utilities\";\nimport { useMsal } from \"../hooks/useMsal\";\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\nimport { InteractionStatus } from \"@azure/msal-browser\";\n\nexport type AuthenticatedTemplateProps = PropsWithChildren<AccountIdentifiers>;\n\n/**\n * Renders child components if user is authenticated\n * @param props \n */\nexport function AuthenticatedTemplate({ username, homeAccountId, localAccountId, children }: AuthenticatedTemplateProps): React.ReactElement|null {\n    const context = useMsal();\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\n        return {\n            username,\n            homeAccountId,\n            localAccountId\n        };\n    }, [username, homeAccountId, localAccountId]);\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n    if (isAuthenticated && context.inProgress !== InteractionStatus.Startup) {\n        return (\n            <React.Fragment>\n                {getChildrenOrFunction(children, context)}\n            </React.Fragment>\n        );\n    }\n    return null;\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport React, { PropsWithChildren, useMemo } from \"react\";\nimport { useMsal } from \"../hooks/useMsal\";\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\nimport { getChildrenOrFunction } from \"../utils/utilities\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\nimport { InteractionStatus } from \"@azure/msal-browser\";\n\nexport type UnauthenticatedTemplateProps = PropsWithChildren<AccountIdentifiers>;\n\n/**\n * Renders child components if user is unauthenticated\n * @param props \n */\nexport function UnauthenticatedTemplate({ username, homeAccountId, localAccountId, children }: UnauthenticatedTemplateProps): React.ReactElement|null {\n    const context = useMsal();\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\n        return {\n            username,\n            homeAccountId,\n            localAccountId\n        };\n    }, [username, homeAccountId, localAccountId]);\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n    if (!isAuthenticated && context.inProgress !== InteractionStatus.Startup && context.inProgress !== InteractionStatus.HandleRedirect) {\n        return (\n            <React.Fragment>\n                {getChildrenOrFunction(children, context)}\n            </React.Fragment>\n        );\n    }\n    return null;\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport { PopupRequest, RedirectRequest, SsoSilentRequest, InteractionType, AuthenticationResult, AuthError, EventMessage, EventType, InteractionStatus } from \"@azure/msal-browser\";\nimport { useIsAuthenticated } from \"./useIsAuthenticated\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\nimport { useMsal } from \"./useMsal\";\n\nexport type MsalAuthenticationResult = {\n    login: Function; \n    result: AuthenticationResult|null;\n    error: AuthError|null;\n};\n\n/**\n * Invokes a login call if a user is not currently signed-in. Failed logins can be retried using the login callback returned.\n * Optionally provide a request object to be used in the login call.\n * Optionally provide a specific user that should be logged in.\n * @param interactionType \n * @param authenticationRequest \n * @param accountIdentifiers \n */\nexport function useMsalAuthentication(\n    interactionType: InteractionType, \n    authenticationRequest?: PopupRequest|RedirectRequest|SsoSilentRequest, \n    accountIdentifiers?: AccountIdentifiers\n): MsalAuthenticationResult {\n    const { instance, inProgress, logger } = useMsal();\n    const isAuthenticated = useIsAuthenticated(accountIdentifiers);\n    const [[result, error], setResponse] = useState<[AuthenticationResult|null, AuthError|null]>([null, null]);\n    const [hasBeenCalled, setHasBeenCalled] = useState<boolean>(false);\n\n    const login = useCallback(async (callbackInteractionType?: InteractionType, callbackRequest?: PopupRequest|RedirectRequest|SsoSilentRequest): Promise<AuthenticationResult|null> => {\n        const loginType = callbackInteractionType || interactionType;\n        const loginRequest = callbackRequest || authenticationRequest;\n        switch (loginType) {\n            case InteractionType.Popup:\n                logger.verbose(\"useMsalAuthentication - Calling loginPopup\");\n                return instance.loginPopup(loginRequest as PopupRequest);\n            case InteractionType.Redirect:\n                // This promise is not expected to resolve due to full frame redirect\n                logger.verbose(\"useMsalAuthentication - Calling loginRedirect\");\n                return instance.loginRedirect(loginRequest as RedirectRequest).then(null);\n            case InteractionType.Silent:\n                logger.verbose(\"useMsalAuthentication - Calling ssoSilent\");\n                return instance.ssoSilent(loginRequest as SsoSilentRequest);\n            default:\n                throw \"Invalid interaction type provided.\";\n        }\n    }, [instance, interactionType, authenticationRequest, logger]);\n\n    useEffect(() => {\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\n            switch(message.eventType) {\n                case EventType.LOGIN_SUCCESS:\n                case EventType.SSO_SILENT_SUCCESS:\n                    if (message.payload) {\n                        setResponse([message.payload as AuthenticationResult, null]);\n                    }\n                    break;\n                case EventType.LOGIN_FAILURE:\n                case EventType.SSO_SILENT_FAILURE:\n                    if (message.error) {\n                        setResponse([null, message.error as AuthError]);\n                    }\n                    break;\n            }\n        });\n        logger.verbose(`useMsalAuthentication - Registered event callback with id: ${callbackId}`);\n\n        return () => {\n            if (callbackId) {\n                logger.verbose(`useMsalAuthentication - Removing event callback ${callbackId}`);\n                instance.removeEventCallback(callbackId);\n            }\n        };\n    }, [instance, logger]);\n\n    useEffect(() => {\n        if (!hasBeenCalled && !error && !isAuthenticated && inProgress === InteractionStatus.None) {\n            logger.info(\"useMsalAuthentication - No user is authenticated, attempting to login\");\n            // Ensure login is only called one time from within this hook, any subsequent login attempts should use the callback returned\n            setHasBeenCalled(true);\n            login().catch(() => {\n                // Errors are handled by the event handler above\n                return;\n            });\n        }\n    }, [isAuthenticated, inProgress, error, hasBeenCalled, login, logger]);\n\n    return { login, result, error };\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport React, { PropsWithChildren, useMemo } from \"react\";\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\nimport { getChildrenOrFunction } from \"../utils/utilities\";\nimport { useMsal } from \"../hooks/useMsal\";\nimport { MsalAuthenticationResult, useMsalAuthentication } from \"../hooks/useMsalAuthentication\";\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\nimport { InteractionType, PopupRequest, RedirectRequest, SsoSilentRequest, InteractionStatus } from \"@azure/msal-browser\";\nimport { IMsalContext } from \"../MsalContext\";\n\nexport type MsalAuthenticationProps = PropsWithChildren<AccountIdentifiers & {\n    interactionType: InteractionType;\n    authenticationRequest?: PopupRequest|RedirectRequest|SsoSilentRequest;\n    loadingComponent?: React.ElementType<IMsalContext>;\n    errorComponent?: React.ElementType<MsalAuthenticationResult>;\n}>;\n\n/**\n * Attempts to authenticate user if not already authenticated, then renders child components\n * @param props\n */\nexport function MsalAuthenticationTemplate({ \n    interactionType, \n    username, \n    homeAccountId, \n    localAccountId,\n    authenticationRequest, \n    loadingComponent: LoadingComponent,\n    errorComponent: ErrorComponent,\n    children \n}: MsalAuthenticationProps): React.ReactElement|null {\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\n        return {\n            username,\n            homeAccountId,\n            localAccountId\n        };\n    }, [username, homeAccountId, localAccountId]);\n    const context = useMsal();\n    const msalAuthResult = useMsalAuthentication(interactionType, authenticationRequest, accountIdentifier);\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\n\n    if (msalAuthResult.error && context.inProgress === InteractionStatus.None) {\n        if (!!ErrorComponent) {\n            return <ErrorComponent {...msalAuthResult} />;\n        }\n\n        throw msalAuthResult.error;\n    }\n    \n    if (isAuthenticated) {\n        return (\n            <React.Fragment>\n                {getChildrenOrFunction(children, msalAuthResult)}\n            </React.Fragment>\n        );\n    } \n    \n    if (!!LoadingComponent && context.inProgress !== InteractionStatus.None) {\n        return <LoadingComponent {...context} />;\n    }\n\n    return null;\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport React from \"react\";\nimport { IMsalContext } from \"../MsalContext\";\nimport { useMsal } from \"../hooks/useMsal\";\nimport { Subtract } from \"../utils/utilities\";\n\nexport type WithMsalProps = {\n    msalContext: IMsalContext;\n};\n\n/**\n * Higher order component wraps provided component with msal by injecting msal context values into the component's props \n * @param Component \n */\nexport const withMsal = <P extends WithMsalProps>(Component: React.ComponentType<P>): React.FunctionComponent<Subtract<P,WithMsalProps>> => {\n    const ComponentWithMsal: React.FunctionComponent<Subtract<P,WithMsalProps>> = props => {\n        const msal = useMsal();\n        return <Component {...(props as P)} msalContext={msal} />;\n    };\n\n    const componentName =\n        Component.displayName || Component.name || \"Component\";\n    ComponentWithMsal.displayName = `withMsal(${componentName})`;\n\n    return ComponentWithMsal;\n};\n"]},"metadata":{},"sourceType":"module"}